<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Gamechooser 2></title>
      </head>
    <header>
        <div id="error_div" style="display:none"></div>
        <button onclick="show_sessions()">Sessions</button>
        <button onclick="show_collection()">Collection</button>
        <button onclick="show_add()">Add</button>
        <button onclick="show_randomizer()">Randomizer</button>
        <button onclick="show_stats()">Stats</button>
    </header>
    <body>
        <div id="sessions_div">
            <h1 id="sessions_header">Sessions</h1>
            <dir id="sessions_filter_div">
                <input type="checkbox" id="sessions_screen_filter_active" checked>
                <label for="sessions_screen_filter_active">Active only</label>
                <input type="checkbox" id="sessions_screen_filter_memorable">
                <label for="sessions_screen_filter_memorable">Memorable only</label>
                <input type="checkbox" id="sessions_screen_filter_year_enable">
                <label for="sessions_screen_filter_year">Limit to year:</label>
                <input type="number" id="sessions_screen_filter_year">
                <button onclick="session_screen_apply_filter()">Apply filters</button>
            </dir>
            <div id="session_screen_session_list"></div>
        </div>
        <div id="collection_div" style="display:none">
            <h1 id="collection_header">Collection</h1>
            <input type="text" id="collection_search_input" onkeypress="collection_search_box_keypress(event)">
            <button onclick="collection_screen_search()">Search collection</button>
            <div id="collection_screen_game_list"></div>
        </div>
        <div id="add_div" style="display:none">
            <h1>Add to collection</h1>
            <input type="text" id="add_screen_name_search_input", onkeypress="add_screen_search_igdb_keypress(event)">
            <input type="checkbox" id="add_screen_games_only" checked>
            <label for="add_screen_games_only">Games only (no DLC, etc)</label>
            <button onclick="add_screen_search_igdb()">Search IGDB</button>
            <div id="add_screen_search_igdb_output"></div>
        </div>
        <div id="randomizer_div" style="display:none">
            <h1>Randomizer</h1>
            <div id="randomizer_options_div">
                <h2>Options</h2>
                <input type="checkbox" id="randomizer_screen_couch">
                <label for="randomizer_screen_couch">Couch playable</label>
                <input type="checkbox" id="randomizer_screen_portable">
                <label for="randomizer_screen_portable">Portable playable</label>
                <input type="checkbox" id="randomizer_screen_allow_unowned">
                <label for="randomizer_screen_allow_unowned">Allow unowned games</label>
                <button onclick="randomizer_screen_start()">Start choosin'</button>
            </div>
            <div id="randomizer_game_div">
                <h3 id="randomizer_game_title"></h3>
                <img id="randomizer_game_cover">
                <p id="randomizer_game_via"></p>
                <button onclick="randomizer_pick_current_game()">Start this game!</button>
                <button onclick="randomizer_pass_current_game()">Pass this game :(</button>
                <button onclick="randomizer_push_current_game()">Push to later</button>
                <button onclick="randomizer_retire_current_game()">Retire</button>
            </div>
        </div>
        <div id="stats_div" style="display:none">
            stats
        </div>
        <div id="game_details_div" style="display:none">
            <h1 id="game_details_title"></h1>
            <p id="game_details_release_date"></p>
            <img id="game_details_cover_art"></img>
            <p id="game_details_via"></p>
            <div id="game_details_tags_and_own"></div>
            <button id="game_details_edit" onclick="game_details_edit()">Edit</button>
            <button id="game_details_reset" onclick="game_details_reset()">Reset choose state</button>
        </div>
        <div id="game_edit_div" style="display:none">
            <h1 id="game_edit_header">Add Game</h1>

            <label for="game_edit_title">Title</label>
            <input type="text" id="game_edit_title">

            <label for="game_edit_release_date">Release date</label>
            <input type="date" id="game_edit_release_date">

            <img id="game_edit_cover_art"></img>

            <label for="game_edit_via">Via</label>
            <input type="text" id="game_edit_via">

            <h3>Tags</h3>
            <div id="game_edit_tags">
            </div>
            <h3>Owned on</h3>
            <div id="game_edit_own">
            </div>
            <div id="game_edit_choose_state">
                <label for="game_edit_next_valid_proposal_date">Next valid choose date</label>
                <input type="date" id="game_edit_next_valid_proposal_date">
                <input type="checkbox" id="game_edit_retired">
                <label for="game_edit_retired">Retired</label>
                <label for="game_edit_passes">Number of passes</label>
                <input type="number" id="game_edit_passes">
                <input type="checkbox" id="game_edit_ignore_passes">
                <label for="game_edit_ignore_passes">Ignore passes during randomizer</label>
            </div>
            <button id="game_edit_submit" onclick="edit_screen_submit()">Add Game</button>
        </div>
        <div id="result_div" style="display:none">
            <p id="result_message"></p>
        </div>
    </body>
    <script>
        function collection_search_box_keypress(e) {
            var key = e.keyCode || e.which;
            if(key == 13) {
                collection_screen_search();
            }
        }
        function add_screen_search_igdb_keypress(e) {
            var key = e.keyCode || e.which;
            if(key == 13) {
                add_screen_search_igdb();
            }
        }
    </script>
    <script type="module">
        import init, {
            cycle_tag_tri_box,
            show_sessions,
            show_collection,
            show_add,
            show_randomizer,
            show_stats,
            add_screen_search_igdb,
            add_screen_add_result,
            edit_screen_submit,
            collection_screen_search,
            collection_screen_view_details,
            collection_screen_edit_game,
            collection_screen_start_session,
            session_screen_finish_session,
            session_screen_apply_filter,
            randomizer_screen_start,
            randomizer_pick_current_game,
            randomizer_pass_current_game,
            randomizer_push_current_game,
            randomizer_retire_current_game,
            game_details_edit,
            game_details_reset,
        } from './rs-wasm-bindgen-output/gamechooser2_client.js';

        async function run() {
            console.log("await init()");
            await init();
            window.cycle_tag_tri_box = cycle_tag_tri_box;
            window.show_sessions = show_sessions;
            window.show_collection = show_collection;
            window.show_add = show_add;
            window.show_randomizer = show_randomizer;
            window.show_stats = show_stats;
            window.add_screen_search_igdb = add_screen_search_igdb;
            window.add_screen_add_result = add_screen_add_result;
            window.edit_screen_submit = edit_screen_submit;
            window.collection_screen_search = collection_screen_search;
            window.collection_screen_view_details = collection_screen_view_details;
            window.collection_screen_edit_game = collection_screen_edit_game;
            window.collection_screen_start_session = collection_screen_start_session;
            window.session_screen_finish_session = session_screen_finish_session;
            window.session_screen_apply_filter = session_screen_apply_filter;
            window.randomizer_screen_start = randomizer_screen_start;
            window.randomizer_pick_current_game = randomizer_pick_current_game;
            window.randomizer_pass_current_game = randomizer_pass_current_game;
            window.randomizer_push_current_game = randomizer_push_current_game;
            window.randomizer_retire_current_game = randomizer_retire_current_game;
            window.game_details_edit = game_details_edit;
            window.game_details_reset = game_details_reset;
            console.log("bindings set");

            show_sessions();
        }

        run();
    </script>
</html>
